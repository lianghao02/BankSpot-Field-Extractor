BankSpot 欄位抽取器 · V1.0

銀行/警察熱點明細 Excel/CSV 合併與格式統一（單檔版）

單一 HTML 檔本地執行，將不同版型的交易/熱點明細抽取為固定 7 欄，支援分頁選擇、表頭排序、直列框選與 CSV 匯出。

✨ 功能特色

多版表頭自動對應：銀行（兩版）＋警察熱點明細 → 輸出固定 7 欄
帳號｜交易日期｜交易時間｜支出金額｜存入金額｜ATM編號｜提款地點

分頁選擇（工作表）：每個 Excel 檔載入時可勾選要處理的 Sheet。

格式統一

日期：YYYYMMDD、民國 7 碼、Excel 序號 → 民國 yyy/mm/dd

時間：hhmmss/hhmm/Excel 時分秒序號 → hh:mm:ss

金額：去正負號與小數；≥10,000 以「萬」顯示（例：23,000 → 2萬3,000）

互動操作

表頭點擊排序（升/降）

直列框選：同一欄上下拖曳即可連續選取

匯出：一鍵匯出 CSV（含 UTF-8 BOM，Excel 直接開）

🗂 支援的輸入欄位對應
統一欄位	候選來源欄位
帳號	帳號、人頭帳戶
交易日期	交易日期、提款日期
交易時間	交易時間、提款時間
支出金額	支出金額、提款金額
存入金額	存入金額（熱點明細無此欄 → 輸出 0）
ATM編號	ATM編號、ATM或端末機代碼
提款地點	提款地點（無對應 → 0）

任一欄找不到或為空值時，統一輸出 0。

🚀 快速開始

下載（或直接開啟）本專案的 HTML 單檔。

以 Chrome/Edge/Firefox 雙擊或拖進瀏覽器即可離線使用。

將 .xlsx / .xls / .csv 檔 拖到頁面，或用「選擇檔案」挑檔。

若檔案含多分頁，彈出清單可勾選要處理的頁面。

檢視結果 → 點表頭可排序；滑鼠於同欄上下拖曳可直列框選。

點「下載 CSV」輸出整併後資料。

🧭 操作提示

排序：點表頭切換 ▲ / ▼；再次點擊同欄切換升/降。

直列框選：按住滑鼠從某格往上/下拖曳，僅選取同一欄。

清空：點「清空結果」可重置已載入資料。

大型檔案：工具會邊讀邊渲染，避免一次等太久。

🔒 隱私與安全

全程離線、純前端：資料只在你的瀏覽器記憶體中處理，不會上傳任何伺服器。

匯出 CSV 會加入 UTF-8 BOM，確保 Excel 顯示中文正常。

✅ 相容性

瀏覽器：Chrome 90+、Edge 90+、Firefox 90+（建議使用 Chromium 系列）

檔案：.xlsx / .xls / .csv

字型/語系：介面預設繁體中文（支援暗黑模式自動切換）

🐞 已知注意事項

金額以「萬」顯示有助閱讀，但若要進一步數值運算，建議使用原始數字或於匯出後再轉回數字欄位。

日期/時間異常（非標準可解析格式）會輸出 0，可在原始表修正。

超大型試算表（數十萬列）仍可能受限於瀏覽器記憶體。

📦 專案結構（單檔）

依賴：xlsx.full.min.js（透過 CDN 載入）

主要模組（內嵌 script）

檔案處理：拖放/選檔、分頁挑選 UI

映射/格式化：表頭正規化、欄位對應、日期/時間/金額格式

渲染：增量重繪表格

互動：排序、直列框選

匯出：CSV（含 BOM）

🧪 測試與驗證建議

準備三種檔案型態：

銀行版 A（含 存入金額）

銀行版 B（欄位名稱略有差異）

熱點明細（含 提款地點、無 存入金額）

驗證重點：

YYYYMMDD、民國 7 碼、Excel 日期序→是否轉為 民國 yyy/mm/dd

hhmmss/hhmm/Excel 時序號 → hh:mm:ss

金額 +/-、小數、千分位 → 去小數、以「萬」顯示

多分頁挑選、排序、直列框選、CSV 匯出正常

🗓 版本資訊
V1.0

首發：多版表頭自動對應 → 統一 7 欄輸出

支援 Excel 多分頁選取

日期/時間/金額格式統一

表頭排序、直列框選

CSV 匯出（UTF-8 BOM）